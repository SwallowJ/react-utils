!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r(require("@swallowj/logjs"),require("dayjs")):"function"==typeof define&&define.amd?define(["@swallowj/logjs","dayjs"],r):"object"==typeof exports?exports["react-utils-script"]=r(require("@swallowj/logjs"),require("dayjs")):e["react-utils-script"]=r(e["@swallowj/logjs"],e.dayjs)}(global,(function(e,r){return(()=>{"use strict";var t={460:r=>{r.exports=e},760:e=>{e.exports=r}},o={};function s(e){var r=o[e];if(void 0!==r)return r.exports;var n=o[e]={exports:{}};return t[e](n,n.exports,s),n.exports}s.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return s.d(r,{a:r}),r},s.d=(e,r)=>{for(var t in r)s.o(r,t)&&!s.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},s.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};return(()=>{s.r(n),s.d(n,{loadModel:()=>v});const e=require("fs");var r=s.n(e);const t=require("path");var o=s.n(t);const a=/(namespace)(\S|\s)*(state:)(\S|\s)*(effects:)(\S|\s)*(reducers:)(\S|\s)*(export default).*/,c=e=>{const t=r().readFileSync(e,{encoding:"utf8"});return a.test(t)};var i=s(460),l=s.n(i);const u=require("child_process"),d=require("crypto");var p=s.n(d);s(760);const f=new Map,y=l().New({name:"model"}),m=e=>o().resolve(process.cwd(),"src",e),j=(e,t)=>{y.Info(`开始扫描目录列表: ${e}`);const s=[];for(;e.length>0;){const n=e.shift();n&&r().readdirSync(n).forEach((a=>{const i=o().resolve(n,a);r().statSync(i).isFile()?t&&!t.test(a)||/\.[jt]sx?$/.test(o().extname(a))&&c(i)&&s.push(i):e.push(i)}))}return s},v=s=>{const{watch:n=!1,pages:a=m("pages"),output:c=m("@/cli/models"),customes:i=[m("models")],namespace:l=""}=s||{};if(!r().statSync(a).isDirectory())throw new Error(`${a} 不是一个目录`);i.forEach((e=>{if(!r().existsSync(e))throw new Error(`目录/文件 ${e} 不存在`)}));const d=o().resolve(c,`${l}.ts`),v=[...j([...i]),...j([a],/model\.[tj]sx?$/)];if(((r,s)=>{const n=(r=>(e.rmSync(r,{force:!0,maxRetries:3}),e.mkdirSync(t.dirname(r),{recursive:!0}),e.createWriteStream(r)))(r);s.forEach((e=>{const r=e.replace(/\.[jt]sx?$/,"");n.write(`export { default as ${(e=>{let r=f.get(e);r||(r=p().createHash("sha256").update(e).copy().digest("hex").slice(0,8),f.set(e,r));let t="";for(const r of e.split(o().sep).reverse())if("model"!==r){t=r.replace(/\s/g,"_");break}return`${t}_${r}`})(r)} } from "${r}";\n`)})),n.close()})(d,v),n){const e=o().resolve(__dirname,"listen");(0,u.fork)(e).send({pages:a,customes:i,output:d,initArry:v})}y.Info("model 加载完成")}})(),n})()}));